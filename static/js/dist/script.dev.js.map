{"version":3,"sources":["script.js"],"names":["$","document","ready","prepend","on","menu","next","hasClass","removeClass","addClass","jQuery","addEventListener","footerLink","getElementById","lightbox","closeLightbox","event","preventDefault","classList","remove","css","add","window","target","load","data","geoJsonData","getJsonData","map_id","position","getPositionFromHash","zoom","center_lon","center_lat","center","targetIcon","L","icon","iconUrl","iconSize","shadowSize","iconAnchor","shadowAnchor","popupAnchor","center_tiles","getTileURL","markers","markerClusterGroup","geoJsonLayer","geoJson","onEachFeature","feature","layer","addLayer","bindPopup","properties","text","drawControl","Control","Draw","draw","polygon","polyline","rectangle","circle","edit","featureGroup","osmclassic_url","osmclassic_attribution","osm_classic","tileLayer","attribution","zoomMin","zoomMax","baseLayers","mapAdd","map","layers","addControl","osm_minimap","TileLayer","minZoom","maxZoom","miniMap","MiniMap","toggleDisplay","addTo","hash","Hash","e","console","log","type","layerType","lat","_latlng","lon","lng","id","_leaflet_id","saveIt","tweettext","insertItem","closePopup","form","openPopup","simplyCountable","maxCount","click","val","tweetIt","twitterBaselink","params","url","location","href","via","attr","param","key","_layers","deleted_item","JSON","stringify","deleteItem","gps","Gps","autoCenter","latlng","getCenter","marker","searchNominatim","query","fetch","headers","Accept","response","json","item","display_name","String","parseFloat","error","searchLocations","callResponse","nominatimResults","sampleDataResults","filter","title","toLowerCase","includes","combinedResults","result","loc","searchControl","control","search","sourceData","then","results","propertyName","propertyLoc","circleMarker","radius","autoCollapse","autoType","minLength","filterData","records","newText","regSearch","RegExp","replace","elem","test","locate","setView","Map","latLng","markersLayer","LayerGroup","i","Marker","Search","container","initial","collapsed","textPlaceholder","textErr"],"mappings":"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","sourcesContent":["( function( $ ) {\r\n$( document ).ready(function() {\r\n$('#cssmenu').prepend('<div id=\"menu-button\">Menu</div>');\r\n\t$('#cssmenu #menu-button').on('click', function(){\r\n\t\tvar menu = $(this).next('ul');\r\n\t\tif (menu.hasClass('open')) {\r\n\t\t\tmenu.removeClass('open');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tmenu.addClass('open');\r\n\t\t}\r\n\t});\r\n});\r\n} )( jQuery );\r\n// privacy popup\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n  const footerLink = document.getElementById(\"footer-link\");\r\n  const lightbox = document.getElementById(\"lightbox\");\r\n  const closeLightbox = document.getElementById(\"close-lightbox\");\r\n\r\n  footerLink.addEventListener(\"click\", function (event) {\r\n    event.preventDefault();\r\n    lightbox.classList.remove(\"lightbox-hidden\");\r\n    $(\"body\").css(\"overflow\", \"hidden\");\r\n  });\r\nif(closeLightbox){\r\n  closeLightbox.addEventListener(\"click\", function () {\r\n    lightbox.classList.add(\"lightbox-hidden\");\r\n    $(\"body\").css(\"overflow\", \"auto\"); // 还原主背景的overflow属性\r\n  });}\r\n\r\n  window.addEventListener(\"click\", function (event) {\r\n    if (event.target === lightbox) {\r\n      lightbox.classList.add(\"lightbox-hidden\");\r\n      $(\"body\").css(\"overflow\", \"auto\"); // 还原主背景的overflow属性\r\n    }\r\n  });\r\n});\r\n//load term of use page in footer \r\n\r\n$(document).ready(function() {\r\n  // 当点击\"terms of use\"链接时，使用jQuery的.load()方法加载terms of use文件\r\n  $(\"#footer-terms-link\").on(\"click\", function(event) {\r\n    event.preventDefault(); // 阻止链接的默认行为\r\n    \r\n    // 使用.load()方法加载terms of use文件，并将其插入到id为\"terms-container\"的div中\r\n    $(\"#terms-container\").load($(this).data(\"target\"));\r\n  });\r\n});\r\n\r\n\r\n\r\n//sample data values for populate map\r\nvar data = [\r\n  {\"loc\":[41.575330,13.102411], \"title\":\"aquamarine\"},\r\n  {\"loc\":[41.575730,13.002411], \"title\":\"black\"},\r\n  {\"loc\":[41.807149,13.162994], \"title\":\"blue\"},\r\n  {\"loc\":[41.507149,13.172994], \"title\":\"chocolate\"},\r\n  {\"loc\":[41.847149,14.132994], \"title\":\"coral\"},\r\n  {\"loc\":[41.219190,13.062145], \"title\":\"cyan\"},\r\n  {\"loc\":[41.344190,13.242145], \"title\":\"darkblue\"},\t\r\n  {\"loc\":[41.679190,13.122145], \"title\":\"darkred\"},\r\n  {\"loc\":[41.329190,13.192145], \"title\":\"darkgray\"},\r\n  {\"loc\":[41.379290,13.122545], \"title\":\"dodgerblue\"},\r\n  {\"loc\":[41.409190,13.362145], \"title\":\"gray\"},\r\n  {\"loc\":[41.794008,12.583884], \"title\":\"green\"},\t\r\n  {\"loc\":[41.805008,12.982884], \"title\":\"greenyellow\"},\r\n  {\"loc\":[41.536175,13.273590], \"title\":\"red\"},\r\n  {\"loc\":[41.516175,13.373590], \"title\":\"rosybrown\"},\r\n  {\"loc\":[41.506175,13.173590], \"title\":\"royalblue\"},\r\n  {\"loc\":[41.836175,13.673590], \"title\":\"salmon\"},\r\n  {\"loc\":[41.796175,13.570590], \"title\":\"seagreen\"},\r\n  {\"loc\":[41.436175,13.573590], \"title\":\"seashell\"},\r\n  {\"loc\":[41.336175,13.973590], \"title\":\"silver\"},\r\n  {\"loc\":[41.236175,13.273590], \"title\":\"skyblue\"},\r\n  {\"loc\":[41.546175,13.473590], \"title\":\"yellow\"},\r\n  {\"loc\":[41.239190,13.032145], \"title\":\"white\"}\r\n];\r\n  var geoJsonData = getJsonData();\r\n  var map_id = geoJsonData['id'];\r\nvar position = getPositionFromHash();\r\n  var zoom = position[0];\r\n  var center_lon = position[1];\r\n  var center_lat = position[2];\r\n\r\n  var center = [center_lat, center_lon];\r\n  var targetIcon = new L.icon({\r\n      iconUrl: './images/target_32x32.png',\r\n      iconSize:     [32, 32],\r\n      shadowSize:   [50, 64],\r\n      iconAnchor:   [12, 41],\r\n      shadowAnchor: [4, 62],\r\n      popupAnchor:  [3, -33]\r\n  });\r\n\r\n  var center_tiles = getTileURL(center[0], center[1], zoom);\r\n\r\n  var markers = L.markerClusterGroup();\r\n\r\n  var geoJsonLayer = L.geoJson(geoJsonData, {\r\n      onEachFeature: function (feature, layer) {\r\n          markers.addLayer(layer);\r\n          layer.bindPopup(feature.properties.text);\r\n      }\r\n  });\r\n\r\n\r\n  var drawControl = new L.Control.Draw({\r\n      draw: {\r\n          position: 'topleft',\r\n          polygon : false,\r\n          polyline : false,\r\n          rectangle : false,\r\n          circle : false\r\n      },\r\n      edit: {\r\n          featureGroup: markers\r\n      }\r\n  });\r\n\r\n\r\n//create map for user to add their own location\r\nvar osmclassic_url = 'http://{s}.tile.osm.org/{z}/{x}/{y}.png';\r\nvar osmclassic_attribution = 'Map data &copy; <a href=\"http://osm.org/copyright\">' +\r\n  'OpenStreetMap</a> contributors, Imagery &copy; OpenStreetMap';\r\nvar osm_classic = L.tileLayer(osmclassic_url, {\r\n      attribution: osmclassic_attribution,\r\n      zoomMin: 2,\r\n      zoomMax: 18\r\n  });\r\nvar baseLayers = {\r\n      \"OSM oggi\": osm_classic,\r\n  };\r\n\r\nvar mapAdd = L.map('mapAdd', {\r\n      layers: [osm_classic],\r\n      center: center,\r\n      zoom: zoom\r\n  });\r\nmapAdd.addControl(drawControl);\r\n\r\n// minimappa\r\n  var osm_minimap = new L.TileLayer(osmclassic_url, {\r\n      minZoom: 0,\r\n      maxZoom: 13\r\n  });\r\n  var miniMap = new L.Control.MiniMap(osm_minimap, {\r\n      toggleDisplay: true\r\n  }).addTo(mapAdd);\r\n\r\n  // hash\r\n  var hash = new L.Hash(mapAdd);\r\n\r\n\r\n\r\n\r\n /*\r\n  * Draw events on map1:\r\n  * * draw:created is fired on node creation\r\n  * * draw:deleted is fired on node deletion (when saving)\r\n  */\r\n\r\n  mapAdd.on('draw:created', function (e) {\r\n      console.log('draw:created');\r\n\r\n      var type = e.layerType,\r\n          layer = e.layer;\r\n\r\n      // drawnItems.addLayer(layer);\r\n      markers.addLayer(layer);\r\n\r\n      var lat = layer._latlng.lat;\r\n      var lon = layer._latlng.lng;\r\n      var id = layer._leaflet_id;\r\n\r\n\r\n      function saveIt(tweettext) {\r\n          insertItem(lat, lon, map_id, id, tweettext);\r\n          layer.closePopup();\r\n          layer.bindPopup(tweettext);\r\n\r\n      }\r\n      \r\n      if (type === 'marker') {\r\n        var form = '<form id=\"inputform\" enctype=\"multipart/form-data\">' +\r\n            '<h4>footprint 1</h4>' +\r\n            '<textarea class=\"form-control\" placeholder=\"Il tuo tweet\" id=\"tweet-text\" name=\"tweet-text\" style=\"font-size: small;\" row=5>' +\r\n              \"film information and my travel #OpenStreetMap!\" +\r\n            '</textarea>' +\r\n            '<div class=\"row-fluid\" style=\"text-align: right;\">' +\r\n              'caratteri: <span id=\"counter\"></span>' +\r\n            '</div>' +\r\n            '<div class=\"row-fluid\">' +\r\n                '<a role=\"button\" class=\"btn save-button\" id=\"save\" title=\"save your footprint\"></a>' +\r\n                '<a role=\"button\" class=\"btn tweet-button\" id=\"tweet\"' +\r\n                    'href=\"https://twitter.com/intent/tweet?via=OpenStreeMapIt&text=L%27agenzia%20delle%20entrate%20copia%20da%20OpenStreetMap!\" ' +\r\n                    'title=\"Save inserted and twittered point!\"></a>' +\r\n            '</div>' +\r\n            '</form>';\r\n\r\n        layer.bindPopup(form).openPopup();\r\n\r\n        $('#tweet').simplyCountable({\r\n          maxCount: 97,\r\n        });\r\n      }\r\n\r\n      $('#save').click(function() {\r\n          var tweettext = $('textarea#tweet-text').val();\r\n          saveIt(tweettext);\r\n      });\r\n\r\n      $('#tweet').click(function tweetIt(event) {\r\n          event.preventDefault();\r\n          var tweettext = $('textarea#tweet-text').val();\r\n          var twitterBaselink = \"https://twitter.com/intent/tweet?\";\r\n          var params = {\r\n              url: window.location.href,\r\n              via: 'OpenStreetMapIt',\r\n              text: tweettext\r\n          };\r\n\r\n          $('#tweet').attr('href', twitterBaselink + $.param(params));\r\n          saveIt(tweettext);\r\n      });\r\n\r\n  });\r\n \r\n  mapAdd.on('draw:deleted', function (e) {\r\n      for ( var key in e.layers._layers ){\r\n        var deleted_item = JSON.stringify(e.layers._layers[key].feature);\r\n        deleteItem(deleted_item, map_id);\r\n      }\r\n  });\r\n\r\n  mapAdd.addLayer(markers);\r\n//定位当前位置\r\n\r\nvar gps = new L.Control.Gps({\r\n  //autoActive:true,\r\n  autoCenter:true\r\n});//inizialize control\r\n\r\ngps\r\n.on('gps:located', function(e) {\r\n  //\te.marker.bindPopup(e.latlng.toString()).openPopup()\r\n  console.log(e.latlng, map.getCenter())\r\n})\r\n.on('gps:disabled', function(e) {\r\n  e.marker.closePopup()\r\n});\r\n\r\ngps.addTo(mapAdd);\r\n  async function searchNominatim(query) {\r\ntry {\r\n  const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${query}`, {\r\n    headers: {\r\n      Accept: 'application/json',\r\n    },\r\n  });\r\n  const data = await response.json();\r\n  return data.map((item) => ({\r\n    display_name: String(item.display_name),\r\n    lat: parseFloat(item.lat),\r\n    lon: parseFloat(item.lon),\r\n  }));\r\n} catch (error) {\r\n  console.error(error);\r\n}\r\n}\r\n\r\n\r\n// 添加新的搜索方法，将 Nominatim 结果与样本数据一起返回\r\nasync function searchLocations(text, callResponse) {\r\nconst nominatimResults = await searchNominatim(text);\r\nconst sampleDataResults = data.filter((item) => item.title.toLowerCase().includes(text.toLowerCase()));\r\n\r\nconst combinedResults = [\r\n  ...nominatimResults.map((result) => ({\r\n    display_name: result.display_name,\r\n    loc: [result.lat, result.lon],\r\n  })),\r\n  ...sampleDataResults.map((result) => ({\r\n    display_name: result.title,\r\n    loc: result.loc,\r\n  })),\r\n];\r\n\r\ncallResponse(combinedResults);\r\n}\r\n\r\n// 更新搜索控件，使用新的搜索方法\r\nvar searchControl = L.control.search({\r\nsourceData: function (text, callResponse) {\r\n  searchNominatim(text).then((results) => {\r\n    callResponse(results);\r\n  });\r\n},\r\npropertyName: 'display_name',\r\npropertyLoc: ['lat', 'lon'],\r\nmarker: L.circleMarker([0, 0], { radius: 30 }),\r\nautoCollapse: true,\r\nautoType: false,\r\nminLength: 2,\r\nfilterData: function (text, records) {\r\n  var newText = String(text);\r\n  var regSearch = new RegExp(newText.replace(/[.?*+^$[\\]\\\\(){}|-]/g, '\\\\$&'), 'i');\r\n  return records.filter(function (elem) {\r\n    return regSearch.test(elem.display_name);\r\n  });\r\n},\r\n}).addTo(mapAdd);\r\n\r\n\r\n// 其他代码与原代码相同\r\n\r\n\r\n  /*\r\n  * Geolocation on the map\r\n  */\r\n\r\n\r\n\r\n  $('#locate-me').click(function() {\r\n      mapAdd.locate({setView: true});\r\n  });\r\n\r\n  /*\r\n  * Update links under the map\r\n  */\r\n  $('.note > a#reportmap-fullscreen').click(function() {\r\n      $( this ).attr('href', '/reportmap.html' + window.location.hash);\r\n  });\r\n\r\n/*\r\n  * Tweet link\r\n  */\r\n  $('.tweet-link').click(function() {\r\n       var twitterBaselink = \"https://twitter.com/intent/tweet?\";\r\n       var params = {\r\n          url: window.location.href,\r\n          via: 'OpenStreeMapIt',\r\n          text: \"L'agenzia delle entrate copia da OpenStreetMap! #agenziauscite\"\r\n      };\r\n\r\n      $( this ).attr('href', twitterBaselink + $.param(params));\r\n  });\r\n\r\n\r\nvar map = new L.Map('map', {zoom: 9, center: new L.latLng(data[0].loc) });\t//set center from first location\r\n\r\n\r\n   // 添加 OpenStreetMap 图层\r\n   L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors',\r\n      maxZoom: 19\r\n    }).addTo(map);\r\n\r\n  var markersLayer = new L.LayerGroup();\t//layer contain searched elements\r\nmap.addLayer(markersLayer);\r\n\r\n\r\n\r\n////////////populate map with markers from sample data\r\nfor(i in data) {\r\n  var title = data[i].title,\t//value searched\r\n    loc = data[i].loc,\t\t//position found\r\n    marker = new L.Marker(new L.latLng(loc), {title: title} );//se property searched\r\n  marker.bindPopup('title: '+ title );\r\n  markersLayer.addLayer(marker);\r\n}\r\n\r\nmap.addControl( new L.Control.Search({\r\n  container: 'findbox',\r\n  layer: markersLayer,\r\n  initial: false,\r\n  collapsed: false,\r\n  textPlaceholder: 'search for a movie ',\r\n  textErr: 'Sorry, no results found.',\r\n\r\n}) );\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  "],"file":"script.dev.js"}