"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}!function(t){t(document).ready(function(){t("#cssmenu").prepend('<div id="menu-button">Menu</div>'),t("#cssmenu #menu-button").on("click",function(){var e=t(this).next("ul");e.hasClass("open")?e.removeClass("open"):e.addClass("open")})})}(jQuery),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("footer-link"),t=document.getElementById("lightbox"),a=document.getElementById("close-lightbox");e.addEventListener("click",function(e){e.preventDefault(),t.classList.remove("lightbox-hidden"),$("body").css("overflow","hidden")}),a&&a.addEventListener("click",function(){t.classList.add("lightbox-hidden"),$("body").css("overflow","auto")}),window.addEventListener("click",function(e){e.target===t&&(t.classList.add("lightbox-hidden"),$("body").css("overflow","auto"))})}),$(document).ready(function(){$("#footer-terms-link").on("click",function(e){e.preventDefault(),$("#terms-container").load($(this).data("target"))})});var data=[{loc:[41.57533,13.102411],title:"aquamarine"},{loc:[41.57573,13.002411],title:"black"},{loc:[41.807149,13.162994],title:"blue"},{loc:[41.507149,13.172994],title:"chocolate"},{loc:[41.847149,14.132994],title:"coral"},{loc:[41.21919,13.062145],title:"cyan"},{loc:[41.34419,13.242145],title:"darkblue"},{loc:[41.67919,13.122145],title:"darkred"},{loc:[41.32919,13.192145],title:"darkgray"},{loc:[41.37929,13.122545],title:"dodgerblue"},{loc:[41.40919,13.362145],title:"gray"},{loc:[41.794008,12.583884],title:"green"},{loc:[41.805008,12.982884],title:"greenyellow"},{loc:[41.536175,13.27359],title:"red"},{loc:[41.516175,13.37359],title:"rosybrown"},{loc:[41.506175,13.17359],title:"royalblue"},{loc:[41.836175,13.67359],title:"salmon"},{loc:[41.796175,13.57059],title:"seagreen"},{loc:[41.436175,13.57359],title:"seashell"},{loc:[41.336175,13.97359],title:"silver"},{loc:[41.236175,13.27359],title:"skyblue"},{loc:[41.546175,13.47359],title:"yellow"},{loc:[41.23919,13.032145],title:"white"}],geoJsonData=getJsonData(),map_id=geoJsonData.id,position=getPositionFromHash(),zoom=position[0],center_lon=position[1],center_lat=position[2],center=[center_lat,center_lon],targetIcon=new L.icon({iconUrl:"./images/target_32x32.png",iconSize:[32,32],shadowSize:[50,64],iconAnchor:[12,41],shadowAnchor:[4,62],popupAnchor:[3,-33]}),center_tiles=getTileURL(center[0],center[1],zoom),markers=L.markerClusterGroup(),geoJsonLayer=L.geoJson(geoJsonData,{onEachFeature:function(e,t){markers.addLayer(t),t.bindPopup(e.properties.text)}}),drawControl=new L.Control.Draw({draw:{position:"topleft",polygon:!1,polyline:!1,rectangle:!1,circle:!1},edit:{featureGroup:markers}}),osmclassic_url="http://{s}.tile.osm.org/{z}/{x}/{y}.png",osmclassic_attribution='Map data &copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors, Imagery &copy; OpenStreetMap',osm_classic=L.tileLayer(osmclassic_url,{attribution:osmclassic_attribution,zoomMin:2,zoomMax:18}),baseLayers={"OSM oggi":osm_classic},mapAdd=L.map("mapAdd",{layers:[osm_classic],center:center,zoom:zoom});mapAdd.addControl(drawControl);var osm_minimap=new L.TileLayer(osmclassic_url,{minZoom:0,maxZoom:13}),miniMap=new L.Control.MiniMap(osm_minimap,{toggleDisplay:!0}).addTo(mapAdd),hash=new L.Hash(mapAdd);mapAdd.on("draw:created",function(e){console.log("draw:created");var t=e.layerType,a=e.layer;markers.addLayer(a);var r=a._latlng.lat,o=a._latlng.lng,n=a._leaflet_id;function i(e){insertItem(r,o,map_id,n,e),a.closePopup(),a.bindPopup(e)}if("marker"===t){a.bindPopup('<form id="inputform" enctype="multipart/form-data"><h4>footprint 1</h4><textarea class="form-control" placeholder="Il tuo tweet" id="tweet-text" name="tweet-text" style="font-size: small;" row=5>film information and my travel #OpenStreetMap!</textarea><div class="row-fluid" style="text-align: right;">caratteri: <span id="counter"></span></div><div class="row-fluid"><a role="button" class="btn save-button" id="save" title="save your footprint"></a><a role="button" class="btn tweet-button" id="tweet"href="https://twitter.com/intent/tweet?via=OpenStreeMapIt&text=L%27agenzia%20delle%20entrate%20copia%20da%20OpenStreetMap!" title="Save inserted and twittered point!"></a></div></form>').openPopup(),$("#tweet").simplyCountable({maxCount:97})}$("#save").click(function(){i($("textarea#tweet-text").val())}),$("#tweet").click(function(e){e.preventDefault();var t=$("textarea#tweet-text").val(),a={url:window.location.href,via:"OpenStreetMapIt",text:t};$("#tweet").attr("href","https://twitter.com/intent/tweet?"+$.param(a)),i(t)})}),mapAdd.on("draw:deleted",function(e){for(var t in e.layers._layers){var a=JSON.stringify(e.layers._layers[t].feature);deleteItem(a,map_id)}}),mapAdd.addLayer(markers);var gps=new L.Control.Gps({autoCenter:!0});function searchNominatim(t){var a,r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(t),{headers:{Accept:"application/json"}}));case 3:return a=e.sent,e.next=6,regeneratorRuntime.awrap(a.json());case 6:return r=e.sent,e.abrupt("return",r.map(function(e){return{display_name:String(e.display_name),lat:parseFloat(e.lat),lon:parseFloat(e.lon)}}));case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}},null,null,[[0,10]])}function searchLocations(t,a){var r,o,n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(searchNominatim(t));case 2:r=e.sent,o=data.filter(function(e){return e.title.toLowerCase().includes(t.toLowerCase())}),n=[].concat(_toConsumableArray(r.map(function(e){return{display_name:e.display_name,loc:[e.lat,e.lon]}})),_toConsumableArray(o.map(function(e){return{display_name:e.title,loc:e.loc}}))),a(n);case 6:case"end":return e.stop()}})}gps.on("gps:located",function(e){console.log(e.latlng,map.getCenter())}).on("gps:disabled",function(e){e.marker.closePopup()}),gps.addTo(mapAdd);var searchControl=L.control.search({sourceData:function(e,t){searchNominatim(e).then(function(e){t(e)})},propertyName:"display_name",propertyLoc:["lat","lon"],marker:L.circleMarker([0,0],{radius:30}),autoCollapse:!0,autoType:!1,minLength:2,filterData:function(e,t){var a=String(e),r=new RegExp(a.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&"),"i");return t.filter(function(e){return r.test(e.display_name)})}}).addTo(mapAdd);$("#locate-me").click(function(){mapAdd.locate({setView:!0})}),$(".note > a#reportmap-fullscreen").click(function(){$(this).attr("href","/reportmap.html"+window.location.hash)}),$(".tweet-link").click(function(){var e={url:window.location.href,via:"OpenStreeMapIt",text:"L'agenzia delle entrate copia da OpenStreetMap! #agenziauscite"};$(this).attr("href","https://twitter.com/intent/tweet?"+$.param(e))});var map=new L.Map("map",{zoom:9,center:new L.latLng(data[0].loc)});L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',maxZoom:19}).addTo(map);var markersLayer=new L.LayerGroup;for(i in map.addLayer(markersLayer),data){var title=data[i].title,loc=data[i].loc,marker=new L.Marker(new L.latLng(loc),{title:title});marker.bindPopup("title: "+title),markersLayer.addLayer(marker)}map.addControl(new L.Control.Search({container:"findbox",layer:markersLayer,initial:!1,collapsed:!1,textPlaceholder:"search for a movie ",textErr:"Sorry, no results found."}));
//# sourceMappingURL=script.min.js.map
